Some stuff in here is custom built.